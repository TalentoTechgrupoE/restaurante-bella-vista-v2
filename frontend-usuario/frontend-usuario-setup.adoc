= ğŸ½ï¸ Frontend Usuario Setup - Bella Vista Restaurant
:toc:
:toc-placement: preamble
:toclevels: 4
:sectanchors:
:sectlinks:
:sectnums:

== ğŸ“‹ GuÃ­a de ConfiguraciÃ³n e InstalaciÃ³n

Esta guÃ­a te ayuda a configurar y ejecutar el frontend de usuario del restaurante Bella Vista paso a paso.

== ğŸ“ Estructura del Proyecto

[source]
----
frontend-usuario/
â”œâ”€â”€ package.json          # Dependencias y scripts de Node.js
â”œâ”€â”€ .env                  # Variables de entorno
â”œâ”€â”€ server.js             # Servidor Express principal
â”œâ”€â”€ Dockerfile            # Contenedor Docker
â”œâ”€â”€ views/                # Plantillas EJS
â”‚   â”œâ”€â”€ index.ejs         # PÃ¡gina principal (menÃº)
â”‚   â”œâ”€â”€ pedido.ejs        # PÃ¡gina de pedidos
â”‚   â”œâ”€â”€ seguimiento.ejs   # Seguimiento de pedidos
â”‚   â””â”€â”€ error.ejs         # PÃ¡gina de errores
â””â”€â”€ public/               # Archivos estÃ¡ticos
    â”œâ”€â”€ css/
    â”‚   â””â”€â”€ style.css     # Estilos CSS
    â””â”€â”€ images/           # ImÃ¡genes del restaurante
----

== ğŸ”§ Prerrequisitos

=== Sistema Operativo
* âœ… Windows 10/11
* âœ… macOS 10.15+
* âœ… Linux (Ubuntu 18.04+)

=== Software Requerido
* ğŸ“¦ *Node.js* v18.0+ - https://nodejs.org/[Descargar]
* ğŸ“¦ *npm* v8.0+ (incluido con Node.js)
* ğŸ—„ï¸ *PostgreSQL* v13+ - https://www.postgresql.org/download/[Descargar]

== ğŸ“ Pasos de InstalaciÃ³n

=== Paso 1: Verificar Dependencias del Sistema

==== Verificar Node.js y npm
[source,bash]
----
# Verificar versiÃ³n de Node.js
node --version

# Verificar versiÃ³n de npm
npm --version

# Verificar que PostgreSQL estÃ© instalado
psql --version
----

*Salida esperada:*
[source]
----
v18.x.x o superior
8.x.x o superior
psql (PostgreSQL) 13.x o superior
----

=== Paso 2: Configurar Base de Datos PostgreSQL

==== Iniciar PostgreSQL

*Windows:*
[source,powershell]
----
# Verificar si PostgreSQL estÃ¡ ejecutÃ¡ndose
Get-Service postgresql*

# Si no estÃ¡ ejecutÃ¡ndose, iniciarlo desde Services
# Abrir services.msc y buscar "postgresql"
----

*Linux/macOS:*
[source,bash]
----
# Verificar estado
sudo systemctl status postgresql

# Iniciar PostgreSQL
sudo systemctl start postgresql

# macOS con Homebrew
brew services start postgresql
----

==== Crear Base de Datos y Usuario
[source,sql]
----
-- Conectar como superusuario
psql -U postgres

-- Crear usuario para el restaurante
CREATE USER restaurante WITH PASSWORD 'bella123';

-- Crear base de datos
CREATE DATABASE bella_vista OWNER restaurante;

-- Otorgar permisos
GRANT ALL PRIVILEGES ON DATABASE bella_vista TO restaurante;

-- Salir
\q
----

=== Paso 3: Inicializar Esquema de Base de Datos

[source,bash]
----
# Ejecutar script de inicializaciÃ³n
psql -U restaurante -d bella_vista -f database/init-db.sql

# Ejecutar migraciones para compatibilidad
psql -U restaurante -d bella_vista -f database/migrate-schema.sql
----

*Verificar que las tablas se crearon:*
[source,sql]
----
-- Conectar a la base de datos
psql -U restaurante -d bella_vista

-- Listar tablas
\dt

-- Verificar datos de ejemplo
SELECT * FROM categorias;
SELECT * FROM platos LIMIT 5;

-- Salir
\q
----

=== Paso 4: Instalar Dependencias de Node.js

[source,bash]
----
# Navegar al directorio del frontend
cd frontend-usuario

# Instalar dependencias
npm install
----

*Dependencias instaladas:*
* `express` - Framework web para Node.js
* `ejs` - Motor de plantillas
* `pg` - Cliente PostgreSQL para Node.js
* `cors` - Middleware para CORS
* `dotenv` - GestiÃ³n de variables de entorno
* `ws` - WebSockets para tiempo real

=== Paso 5: Verificar ConfiguraciÃ³n

==== Verificar archivo .env
[source,bash]
----
# Verificar que existe el archivo .env
cat frontend-usuario/.env
----

*Contenido esperado:*
[source,properties]
----
NODE_ENV=development
PORT=3000

# Database configuration
DB_HOST=localhost
DB_PORT=5432
DB_NAME=bella_vista
DB_USER=restaurante
DB_PASSWORD=bella123
----

==== Probar ConexiÃ³n a Base de Datos
[source,bash]
----
# Desde el directorio frontend-usuario
node -e "
const { Pool } = require('pg');
require('dotenv').config();
const pool = new Pool({
  host: process.env.DB_HOST,
  port: process.env.DB_PORT,
  database: process.env.DB_NAME,
  user: process.env.DB_USER,
  password: process.env.DB_PASSWORD,
});
pool.query('SELECT NOW()', (err, res) => {
  if (err) {
    console.log('âŒ Error:', err.message);
  } else {
    console.log('âœ… ConexiÃ³n exitosa:', res.rows[0].now);
  }
  process.exit();
});
"
----

=== Paso 6: Ejecutar el Frontend

==== Modo Desarrollo (con recarga automÃ¡tica)
[source,bash]
----
# Desde el directorio frontend-usuario
npm run dev
----

==== Modo ProducciÃ³n
[source,bash]
----
# Desde el directorio frontend-usuario
npm start
----

*Salida esperada:*
[source]
----
ğŸ½ï¸ Bella Vista Frontend Usuario ejecutÃ¡ndose en http://localhost:3000
ğŸ“Š Estado de la base de datos: âœ… Conectada
ğŸ“‹ Rutas disponibles:
   ğŸ  GET  /                    - PÃ¡gina principal (menÃº)
   ğŸ›’ GET  /pedido              - PÃ¡gina de pedidos
   ğŸ“Š GET  /seguimiento/:numero - Seguimiento de pedido
   ğŸ“¡ GET  /api/menu            - API del menÃº
   ğŸ“¡ GET  /api/categorias      - API de categorÃ­as
   ğŸ“¡ POST /api/pedidos         - API crear pedido
   ğŸ“¡ GET  /api/pedidos/:numero - API estado pedido
----

=== Paso 7: Verificar Funcionamiento

==== Abrir en Navegador
[source,bash]
----
# Abrir la aplicaciÃ³n
http://localhost:3000
----

==== Probar APIs
[source,bash]
----
# Probar API de categorÃ­as
curl http://localhost:3000/api/categorias

# Probar API de menÃº
curl http://localhost:3000/api/menu

# Crear pedido de prueba
curl -X POST http://localhost:3000/api/pedidos \
  -H "Content-Type: application/json" \
  -d '{
    "numero_mesa": 1,
    "cliente_nombre": "Test Usuario",
    "items": [
      {
        "producto_id": 1,
        "cantidad": 2,
        "notas_item": "Sin cebolla"
      }
    ],
    "notas": "Pedido de prueba"
  }'
----

== ğŸ³ EjecuciÃ³n con Docker (Opcional)

=== Construir Imagen
[source,bash]
----
# Desde el directorio frontend-usuario
docker build -t bella-vista-frontend .
----

=== Ejecutar Contenedor
[source,bash]
----
# Ejecutar contenedor
docker run -p 3000:3000 \
  -e DB_HOST=host.docker.internal \
  -e DB_PORT=5432 \
  -e DB_NAME=bella_vista \
  -e DB_USER=restaurante \
  -e DB_PASSWORD=bella123 \
  bella-vista-frontend
----

== ğŸ”§ SoluciÃ³n de Problemas

=== Error: "Cannot connect to database"
[source,bash]
----
# Verificar que PostgreSQL estÃ© ejecutÃ¡ndose
sudo systemctl status postgresql

# Verificar credenciales en .env
cat frontend-usuario/.env

# Probar conexiÃ³n manual
psql -U restaurante -d bella_vista -c "SELECT 1;"
----

=== Error: "EADDRINUSE :::3000"
[source,bash]
----
# Puerto 3000 ocupado, cambiar puerto
export PORT=3001

# O modificar .env
echo "PORT=3001" >> frontend-usuario/.env
----

=== Error: "Module not found"
[source,bash]
----
# Reinstalar dependencias
cd frontend-usuario
rm -rf node_modules package-lock.json
npm install
----

== ğŸ“Š Scripts Disponibles

[source,bash]
----
# Instalar dependencias
npm install

# Ejecutar en modo desarrollo
npm run dev

# Ejecutar en modo producciÃ³n
npm start

# Probar estructura del proyecto
chmod +x test-frontend.sh
./test-frontend.sh
----

== ğŸŒ URLs y Endpoints

=== PÃ¡ginas Web
* ğŸ  *PÃ¡gina Principal*: http://localhost:3000/
* ğŸ›’ *Realizar Pedido*: http://localhost:3000/pedido
* ğŸ“Š *Seguimiento*: http://localhost:3000/seguimiento/P000001

=== APIs
* ğŸ“¡ *CategorÃ­as*: GET /api/categorias
* ğŸ“¡ *MenÃº*: GET /api/menu
* ğŸ“¡ *Crear Pedido*: POST /api/pedidos
* ğŸ“¡ *Estado Pedido*: GET /api/pedidos/:numero

== âœ… Lista de VerificaciÃ³n Final

* [ ] Node.js y npm instalados
* [ ] PostgreSQL ejecutÃ¡ndose
* [ ] Base de datos `bella_vista` creada
* [ ] Usuario `restaurante` configurado
* [ ] Tablas inicializadas con `init-db.sql`
* [ ] Migraciones aplicadas con `migrate-schema.sql`
* [ ] Dependencias de Node.js instaladas
* [ ] Archivo `.env` configurado correctamente
* [ ] ConexiÃ³n a base de datos exitosa
* [ ] Frontend ejecutÃ¡ndose en http://localhost:3000
* [ ] APIs respondiendo correctamente

'''

*Ãšltima actualizaciÃ³n*: Julio 6, 2025 +
*Proyecto*: Bella Vista Restaurant +
*VersiÃ³n*: 1.0
